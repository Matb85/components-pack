import{m as w}from"./index.MGJcI3eh.js";import{G as f}from"./astro-pack.C0yKslky.js";const E={easing:"ease",container:"",transitionSpeed:300,initialSlide:0,plugins:[]},T={once:!0};var r=(s=>(s.TR_END="MS-transitionend",s.TR_START="transitionstart",s.MV="MS-moving",s.DRAG_START="MS-pointer-drag-start",s.DRAG_END="MS-pointer-drag-end",s))(r||{});class S{constructor(t){this.counter=0,this.pos={start:0,x1:0,x2:0,y1:0,y2:0},this.plugins={},this.destroyers={},this.isMoving=!1,this.isDestroyed=!1,this.settings={...E,...t},this.container=document.getElementById(t.container),this.slides=this.container.children,this.container.style.setProperty("--number-of-slides",this.slides.length.toString()),this.slideWidth=this.calcSlideWidth(),this.slidesPerView=this.getSlidesPerView(),this.addDocListener("resize",()=>{this.slideWidth=this.calcSlideWidth(),this.slidesPerView=this.getSlidesPerView()}),this.init();for(const e of this.settings.plugins)this.plugins[e.name]=e.call(this);this.goTo(this.settings.initialSlide)}getTransX(){return parseFloat(window.getComputedStyle(this.container).transform.split(", ")[4])}getProperty(t,e){return parseInt(window.getComputedStyle(t).getPropertyValue(e))}calcSlideWidth(){return this.slides[0].offsetWidth+this.getProperty(this.slides[0],"margin-left")+this.getProperty(this.slides[0],"margin-right")}getSlidesPerView(){const t=this.getProperty(this.container.parentElement,"--slides-per-view");return isNaN(t)?this.getProperty(document.documentElement,"--slides-per-view"):t}transform(t){this.container.style.transform="translate3d("+this.slideWidth*t+"px,0,0)"}transformAbsolute(t){this.container.style.transform="translate3d("+t+"px,0,0)"}setTransition(t){this.container.style.transition="transform "+t+"ms "+this.settings.easing}clearTransition(){this.container.style.transition="initial"}dispatchEvent(t){this.container.dispatchEvent(new CustomEvent(t))}addTempConListener(t,e,o){this.onDestroy(()=>this.container.removeEventListener(t,o),e),this.container.addEventListener(t,o,T)}addConListener(t,e){this.onDestroy(()=>this.container.removeEventListener(t,e)),this.container.addEventListener(t,e)}addDocListener(t,e){this.onDestroy(()=>document.removeEventListener(t,e)),document.addEventListener(t,e)}onDestroy(t,e){const o=e||Date.now()+"";return this.destroyers[o]=t,o}destroy(){for(const t in this.destroyers)this.destroyers[t]();this.transform(0),this.isDestroyed=!0}}class b extends S{getCurrentSlide(){return this.counter*-1}slideNext(t=this.settings.transitionSpeed){return this.base(Math.ceil((this.pos.start-this.getTransX())/this.slideWidth)||1,t)}slidePrev(t=this.settings.transitionSpeed){return this.base(Math.floor((this.pos.start-this.getTransX())/this.slideWidth)||-1,t)}slideTo(t=0,e){return this.slideBy(t-Math.abs(this.counter),e)}slideBy(t=0,e){return t===0?new Promise(o=>o()):this.base(t,e)}goTo(t=0){return this.slideTo(t,0)}init(){}base(t,e=this.settings.transitionSpeed){return new Promise(o=>{if(this.isMoving)return o();this.isMoving=!0,this.counter-=t,this.counter>0&&(this.counter=0),this.counter<-1*(this.slides.length-this.slidesPerView)&&(this.counter=-1*(this.slides.length-this.slidesPerView)),this.setTransition(e),this.transform(this.counter);const a=()=>{this.clearTransition(),this.isMoving=!1,this.pos.start=this.getTransX(),this.dispatchEvent(r.TR_END),o()};e!==0?setTimeout(()=>a(),e):a()})}}const M=()=>function(){this.addTempConListener("pointerdown","pointerdown",s=>m.call(this,s))};function m(s){switch(this.pos.start=this.getTransX(),this.pos.x2=s.clientX,this.isMoving=!0,s.pointerType){case"mouse":this.dispatchEvent(r.DRAG_START),document.onmousemove=P.bind(this),document.onmouseup=u.bind(this);break;case"touch":this.dispatchEvent(r.DRAG_START),document.ontouchmove=x.bind(this),document.ontouchend=u.bind(this);break}}function P(s){this.pos.x1=this.pos.x2-s.clientX,this.pos.x2=s.clientX,this.transformAbsolute(this.getTransX()-this.pos.x1),this.dispatchEvent(r.MV)}function x(s){this.pos.x1=this.pos.x2-s.touches[0].clientX,this.pos.x2=s.touches[0].clientX,this.pos.y1=this.pos.y2-s.touches[0].clientY,this.pos.y2=s.touches[0].clientY,Math.abs(this.pos.y1)<Math.abs(this.pos.x1)&&this.transformAbsolute(this.getTransX()-this.pos.x1),this.dispatchEvent(r.MV)}async function u(){document.onmousemove=null,document.ontouchmove=null,document.ontouchend=null,document.onmouseup=null,this.isMoving=!1,this.dispatchEvent(r.DRAG_END),this.container.onpointerdown=null,this.pos.start!=this.getTransX()&&(this.pos.start>this.getTransX()?await this.slideNext():await this.slidePrev()),this.addTempConListener("pointerdown","pointerdown",s=>m.call(this,s))}const h=document.getElementById("MP-multi-viewer-viewed-photo"),L=document.getElementById("MP-multi-viewer"),g=document.getElementById("photo-slider"),p=document.getElementById("multi-viewer-counter"),D=document.getElementById("multi-viewer-prev"),A=document.getElementById("multi-viewer-next"),k=document.getElementById("close-multi-viewer");let i,l=0;const c=new w(h,L,f);function y(s){i&&(s.key==="Escape"?v():s.key==="ArrowLeft"?i.slidePrev():s.key==="ArrowRight"&&i.slideNext())}window.addEventListener("enlargeManyPhotos",async s=>{const{detail:t}=s;window.addEventListener("keyup",y);const e=c.setupImgs(window.astroPack,t.img);g.innerHTML=e.photos.map(n=>`
    <img
        class="other-slide MS-lazy"
        src="${n.src}"
        data-srcset="${n.srcset}"
        alt="${n.alt||"zdjÄ™cie bez podpisu"}"
        data-observerhandler="photo" />
    `).join(""),await c.mounted(t),i=new b({container:"photo-slider",transitionSpeed:500,plugins:[M()]});const o=i.container.children[e.index];window.astroPack.handlers.photo(o),i.container.querySelectorAll(".MS-lazy").forEach(n=>window.astroPack.observer.observe(n)),h.addEventListener("animationend",()=>h.parentElement.style.display="none",{once:!0}),l=i.counter,Object.defineProperty(i,"counter",{get:()=>l,set:n=>{l=n;const d=e.photos[Math.abs(n)];p.innerText=`${Math.abs(n)+1}/${e.photos.length} ${d&&d.alt?" | "+d.alt:""}`}}),setTimeout(()=>{i?.goTo(e.index);const n=e.photos[Math.abs(e.index)];p.innerText=`${Math.abs(e.index)+1}/${e.photos.length} ${n&&n.alt?" | "+n.alt:""}`},0)});async function v(){await c.close(),h.parentElement.style.display="block",i?.goTo(0),i?.destroy(),g.innerHTML="",i=void 0,window.removeEventListener("keyup",y)}A.addEventListener("click",()=>i?.slideNext());D.addEventListener("click",()=>i?.slidePrev());k.addEventListener("click",v);
