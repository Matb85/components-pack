import{m as v}from"./index.DWyHuE9n.js";import{G as w}from"./astro-pack.C0yKslky.js";const f={easing:"ease",container:"",transitionSpeed:300,initialSlide:0,plugins:[]},E={once:!0};var r=(e=>(e.TR_END="MS-transitionend",e.TR_START="transitionstart",e.MV="MS-moving",e.DRAG_START="MS-pointer-drag-start",e.DRAG_END="MS-pointer-drag-end",e))(r||{});class T{constructor(t){this.counter=0,this.pos={start:0,x1:0,x2:0,y1:0,y2:0},this.plugins={},this.destroyers={},this.isMoving=!1,this.isDestroyed=!1,this.settings={...f,...t},this.container=document.getElementById(t.container),this.slides=this.container.children,this.container.style.setProperty("--number-of-slides",this.slides.length.toString()),this.slideWidth=this.calcSlideWidth(),this.slidesPerView=this.getSlidesPerView(),this.addDocListener("resize",()=>{this.slideWidth=this.calcSlideWidth(),this.slidesPerView=this.getSlidesPerView()}),this.init();for(const s of this.settings.plugins)this.plugins[s.name]=s.call(this);this.goTo(this.settings.initialSlide)}getTransX(){return parseFloat(window.getComputedStyle(this.container).transform.split(", ")[4])}getProperty(t,s){return parseInt(window.getComputedStyle(t).getPropertyValue(s))}calcSlideWidth(){return this.slides[0].offsetWidth+this.getProperty(this.slides[0],"margin-left")+this.getProperty(this.slides[0],"margin-right")}getSlidesPerView(){const t=this.getProperty(this.container.parentElement,"--slides-per-view");return isNaN(t)?this.getProperty(document.documentElement,"--slides-per-view"):t}transform(t){this.container.style.transform="translate3d("+this.slideWidth*t+"px,0,0)"}transformAbsolute(t){this.container.style.transform="translate3d("+t+"px,0,0)"}setTransition(t){this.container.style.transition="transform "+t+"ms "+this.settings.easing}clearTransition(){this.container.style.transition="initial"}dispatchEvent(t){this.container.dispatchEvent(new CustomEvent(t))}addTempConListener(t,s,n){this.onDestroy(()=>this.container.removeEventListener(t,n),s),this.container.addEventListener(t,n,E)}addConListener(t,s){this.onDestroy(()=>this.container.removeEventListener(t,s)),this.container.addEventListener(t,s)}addDocListener(t,s){this.onDestroy(()=>document.removeEventListener(t,s)),document.addEventListener(t,s)}onDestroy(t,s){const n=s||Date.now()+"";return this.destroyers[n]=t,n}destroy(){for(const t in this.destroyers)this.destroyers[t]();this.transform(0),this.isDestroyed=!0}}class S extends T{getCurrentSlide(){return this.counter*-1}slideNext(t=this.settings.transitionSpeed){return this.base(Math.ceil((this.pos.start-this.getTransX())/this.slideWidth)||1,t)}slidePrev(t=this.settings.transitionSpeed){return this.base(Math.floor((this.pos.start-this.getTransX())/this.slideWidth)||-1,t)}slideTo(t=0,s){return this.slideBy(t-Math.abs(this.counter),s)}slideBy(t=0,s){return t===0?new Promise(n=>n()):this.base(t,s)}goTo(t=0){return this.slideTo(t,0)}init(){}base(t,s=this.settings.transitionSpeed){return new Promise(n=>{if(this.isMoving)return n();this.isMoving=!0,this.counter-=t,this.counter>0&&(this.counter=0),this.counter<-1*(this.slides.length-this.slidesPerView)&&(this.counter=-1*(this.slides.length-this.slidesPerView)),this.setTransition(s),this.transform(this.counter);const a=()=>{this.clearTransition(),this.isMoving=!1,this.pos.start=this.getTransX(),this.dispatchEvent(r.TR_END),n()};s!==0?setTimeout(()=>a(),s):a()})}}const P=()=>function(){this.addTempConListener("pointerdown","pointerdown",e=>p.call(this,e))};function p(e){switch(this.pos.start=this.getTransX(),this.pos.x2=e.clientX,this.isMoving=!0,e.pointerType){case"mouse":this.dispatchEvent(r.DRAG_START),document.onmousemove=b.bind(this),document.onmouseup=u.bind(this);break;case"touch":this.dispatchEvent(r.DRAG_START),document.ontouchmove=M.bind(this),document.ontouchend=u.bind(this);break}}function b(e){this.pos.x1=this.pos.x2-e.clientX,this.pos.x2=e.clientX,this.transformAbsolute(this.getTransX()-this.pos.x1),this.dispatchEvent(r.MV)}function M(e){this.pos.x1=this.pos.x2-e.touches[0].clientX,this.pos.x2=e.touches[0].clientX,this.pos.y1=this.pos.y2-e.touches[0].clientY,this.pos.y2=e.touches[0].clientY,Math.abs(this.pos.y1)<Math.abs(this.pos.x1)&&this.transformAbsolute(this.getTransX()-this.pos.x1),this.dispatchEvent(r.MV)}async function u(){document.onmousemove=null,document.ontouchmove=null,document.ontouchend=null,document.onmouseup=null,this.isMoving=!1,this.dispatchEvent(r.DRAG_END),this.container.onpointerdown=null,this.pos.start!=this.getTransX()&&(this.pos.start>this.getTransX()?await this.slideNext():await this.slidePrev()),this.addTempConListener("pointerdown","pointerdown",e=>p.call(this,e))}const h=document.getElementById("MP-multi-viewer-viewed-photo"),x=document.getElementById("MP-multi-viewer"),m=document.getElementById("photo-slider"),L=document.getElementById("multi-viewer-counter"),D=document.getElementById("multi-viewer-prev"),A=document.getElementById("multi-viewer-next"),k=document.getElementById("close-multi-viewer");let i,l=0;const c=new v(h,x,w);function g(e){i&&(e.key==="Escape"?y():e.key==="ArrowLeft"?i.slidePrev():e.key==="ArrowRight"&&i.slideNext())}window.addEventListener("enlargeManyPhotos",async e=>{const{detail:t}=e;window.addEventListener("keyup",g);const s=c.setupImgs(window.astroPack,t.img);m.innerHTML=s.photos.map(o=>`
    <img
        class="other-slide MS-lazy"
        src="${o.src}"
        data-srcset="${o.srcset}"
        alt="${o.alt||"zdjÄ™cie bez podpisu"}"
        data-observerhandler="photo" />
    `).join(""),await c.mounted(t),i=new S({container:"photo-slider",transitionSpeed:500,plugins:[P()]});const n=i.container.children[s.index];window.astroPack.handlers.photo(n),i.container.querySelectorAll(".MS-lazy").forEach(o=>window.astroPack.observer.observe(o)),h.addEventListener("animationend",()=>h.parentElement.style.display="none",{once:!0}),l=i.counter,Object.defineProperty(i,"counter",{get:()=>l,set:o=>{l=o;const d=s.photos[Math.abs(o)];L.innerText=`${Math.abs(o)+1}/${s.photos.length} ${d&&d.alt?" | "+d.alt:""}`}}),console.log(s),setTimeout(()=>i?.goTo(s.index),0)});async function y(){await c.close(),h.parentElement.style.display="block",i?.goTo(0),i?.destroy(),m.innerHTML="",i=void 0,window.removeEventListener("keyup",g)}A.addEventListener("click",()=>i?.slideNext());D.addEventListener("click",()=>i?.slidePrev());k.addEventListener("click",y);
